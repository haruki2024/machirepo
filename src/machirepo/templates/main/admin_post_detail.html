{% extends 'top_base.html' %} 

{% block title %}報告の詳細 - まちレポ管理者{% endblock %}

{% block extra_head %}
    <!-- 注: 地図（Leaflet）関連のCSSはすべて削除しました。 -->
    <!-- スタイルは外部CSS（style.css）またはベーステンプレートに依存します。 -->
{% endblock %}

{% block content %}

<body class="p-4 md:p-8">
    <!-- ページコンテナとヘッダーのクラス名は、参照元HTMLに合わせ、Tailwindクラスから移行します -->
    <div class="page-container">

        <header class="app-header">
            <div class="title">まちレポ 管理者ページ</div>
            <!-- ログアウトリンク (urls.pyの'logout'を使用) -->
            <a href="{% url 'logout' %}" class="header-link">ログアウト</a>
        </header>
        
        <main class="main-content">
            <a href="{% url 'admin_post_list' %}" class="link-secondary" style="margin: 0 0 1.5rem 0; text-align: left;"> &lt; 管理メニューに戻る
            </a>


            <!-- 写真 -->
            <div class="form-group mb-6">
                <label class="block text-gray-700 font-medium mb-2">写真:</label>
                <div class="bg-gray-200 rounded-md overflow-hidden border border-gray-300 h-64">
                    {% if post.photo %}
                        <img src="{{ post.photo.url }}" alt="報告写真" class="w-full h-full object-cover">
                    {% else %}
                        <div class="w-full h-full flex items-center justify-center text-gray-500">
                            写真がありません
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- 場所 (テキスト情報のみ) -->
            <div class="form-group mb-6">
                <label class="block text-gray-700 font-medium mb-2">場所:</label>
                <!-- 元のHTMLに合わせて背景やボーダーはそのまま残します。 -->
                <div class="bg-gray-50 rounded-md border border-gray-300 p-3">
                    <p class="text-gray-800">
                        {% if post.location_name %}
                            {{ post.location_name }}
                        {% elif post.latitude and post.longitude %}
                            緯度: {{ post.latitude }}, 経度: {{ post.longitude }}
                        {% else %}
                            位置情報は記録されていません
                        {% endif %}
                    </p>
                </div>
            </div>

            <!-- カテゴリ -->
            <div class="form-group mb-6">
                <label class="block text-gray-700 font-medium mb-1">カテゴリ:</label>
                <p class="text-gray-800">
                    {% for tag in post.tags.all %}
                        <span class="inline-block bg-indigo-100 text-indigo-700 text-sm px-2 py-0.5 rounded-full mr-1">{{ tag.name }}</span>
                    {% endfor %}
                </p>
            </div>

            <!-- 詳細 -->
            <div class="form-group mb-6">
                <label class="block text-gray-700 font-medium mb-1">詳細:</label>
                <p class="bg-gray-50 p-3 border border-gray-300 rounded-md whitespace-pre-wrap">{{ post.comment }}</p>
            </div>
            
            <!-- 管理者メモ/対応内容 -->
            {% if post.admin_note %}
            <div class="form-group mb-6 p-3 bg-indigo-50 border border-indigo-200 rounded-md">
                <label class="block text-indigo-700 font-medium mb-1">管理者メモ/対応内容:</label>
                <p class="text-indigo-800 whitespace-pre-wrap">{{ post.admin_note }}</p>
            </div>
            {% endif %}

        

            <!-- アクションボタン -->
            <div class="flex space-x-4 mt-8 pt-4 border-t border-gray-200">
                <!-- 元のHTML: <a href="admin_status_edit.html" class="btn btn-primary">ステータスを記録する</a> -->
                <a href="{% url 'admin_post_status_edit' post.id %}" class="btn btn-primary">
                    ステータスを記録する
                </a>
                
                <!-- 削除リンクは、URL未定義エラーを避けるため、引き続きコメントアウトを維持します。 -->
                {% comment %}
                <!-- 元のHTML: <a href="admin_delete_confirm.html" class="btn btn-secondary" style="border: 1px solid #ef4444; color: #ef4444;">この報告を削除する</a> -->
                <a href="{% url 'admin_post_delete' post.id %}" class="btn btn-secondary" style="border: 1px solid #ef4444; color: #ef4444;">
                    この報告を削除する
                </a>
                {% endcomment %}
            </div>
        </main>

    </div>
</div>

<!-- 地図関連のJavaScriptもすべて削除しました。 -->
{% endblock %}
