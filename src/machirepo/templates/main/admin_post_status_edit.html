{% extends 'top_base.html' %} 

{% load static %}

{% block title %}ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¨˜éŒ²ãƒ»æ›´æ–° | ç®¡ç†è€…{% endblock %}

{% block extra_head %}
    <style>
        /* ğŸ’¡ å…±é€šã®ã‚¹ã‚¿ã‚¤ãƒ«ã¨Tailwindã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’çµ±åˆ */
        .page-container { max-width: 800px; margin: 0 auto; padding: 0 1rem; }
        .form-label { display: block; font-weight: 600; color: #1f2937; margin-bottom: 0.5rem; }
        .form-input-style {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: border-color 0.15s;
        }
        .form-input-style:focus {
            outline: none;
            border-color: #4f46e5; /* indigo-600 */
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
        }
        .error-message { color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem; }
        
        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .status-badge { display: inline-block; padding: 0.2rem 0.6rem; border-radius: 9999px; font-weight: 600; font-size: 0.875rem; }
        .status-0 { background-color: #fee2e2; color: #b91c1c; } /* æœªå¯¾å¿œ: èµ¤ç³» */
        .status-1 { background-color: #fffbeb; color: #b45309; } /* å¯¾å¿œä¸­: é»„ç³» */
        .status-2 { background-color: #d1fae5; color: #047857; } /* å¯¾å¿œå®Œäº†: ç·‘ç³» */

        /* å„ªå…ˆåº¦ãƒãƒƒã‚¸ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .priority-badge { display: inline-block; padding: 0.2rem 0.6rem; border-radius: 9999px; font-weight: 600; font-size: 0.875rem; margin-left: 0.5rem; }
        .priority-0 { background-color: #e0f2fe; color: #075985; } /* ä½: é’ç³» */
        .priority-1 { background-color: #fef9c3; color: #a16207; } /* ä¸­: é»„ç³» */
        .priority-2 { background-color: #fecaca; color: #b91c1c; } /* é«˜: èµ¤ç³» */

    </style>
{% endblock %}

{% block content %}

<div class="page-container">
    
    <header class="flex justify-between items-center py-4 border-b">
        <h1 class="text-2xl font-bold text-gray-800">å ±å‘Šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®è¨˜éŒ²</h1>
        <a href="{% url 'main:admin_post_detail' post.id %}" class="text-indigo-600 hover:text-indigo-800 text-sm font-semibold">
            &lt; è©³ç´°ã«æˆ»ã‚‹
        </a>
    </header>

    <main class="mt-6">
        
        <div class="mb-6 p-4 bg-indigo-50 border-l-4 border-indigo-500 rounded-lg shadow-sm">
            <h2 class="text-lg text-indigo-700 font-bold mb-1">{{ post.title }}</h2>
            <p class="text-sm text-indigo-600">å ±å‘Šè€…: {{ post.user.last_name }} æ§˜ | å ±å‘Šæ—¥æ™‚: {{ post.posted_at|date:"Y/m/d H:i" }}</p>
        </div>

        <div class="flex space-x-4 mb-8">
            <div class="flex-1 p-3 bg-white border border-gray-200 rounded-lg shadow-sm">
                <p class="text-sm font-medium text-gray-500 mb-1">ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</p>
                <span class="status-badge status-{{ post.status|default:0 }}">
                    {{ post.get_status_display|default:"æœªå¯¾å¿œ" }}
                </span>
            </div>
            <div class="flex-1 p-3 bg-white border border-gray-200 rounded-lg shadow-sm">
                <p class="text-sm font-medium text-gray-500 mb-1">ç¾åœ¨ã®å„ªå…ˆé †ä½</p>
                <span class="priority-badge priority-{{ post.priority|default:0 }}">
                    {{ post.get_priority_display|default:"ä½" }}
                </span>
            </div>
        </div>

        <form method="post" action="{% url 'main:admin_post_status_edit' post.id %}" class="space-y-6">
            {% csrf_token %}
            
            {% if form.non_field_errors %}
                <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                    <strong class="font-bold mr-2">å…¥åŠ›ã‚¨ãƒ©ãƒ¼:</strong>
                    {% for error in form.non_field_errors %}
                        <span class="block sm:inline">{{ error }}</span>
                    {% endfor %}
                </div>
            {% endif %}

            <div>
                <label for="{{ form.status.id_for_label }}" class="form-label">
                    {{ form.status.label }} <span class="text-red-500">*</span>
                </label>
                {{ form.status|add_class:"form-input-style form-select" }}
                {% if form.status.errors %}
                    <div class="error-message">{{ form.status.errors.0 }}</div>
                {% endif %}
            </div>

            <div>
                <label for="{{ form.priority.id_for_label }}" class="form-label">{{ form.priority.label }}</label>
                {{ form.priority|add_class:"form-input-style form-select" }}
                {% if form.priority.errors %}
                    <div class="error-message">{{ form.priority.errors.0 }}</div>
                {% endif %}
            </div>

            <div>
                <label for="{{ form.admin_note.id_for_label }}" class="form-label">
                    {{ form.admin_note.label }} <span class="text-red-500">*</span>
                </label>
                {{ form.admin_note|add_class:"form-input-style form-textarea" }}
                {% if form.admin_note.errors %}
                    <div class="error-message">{{ form.admin_note.errors.0 }}</div>
                {% endif %}
                <p class="text-sm text-red-600 mt-2 p-2 bg-red-50 border border-red-200 rounded">
                    ğŸš¨ **æ³¨æ„:** ã“ã®ã‚³ãƒ¡ãƒ³ãƒˆã¯ã€**å ±å‘Šè€…ï¼ˆä½æ°‘ï¼‰ã®æŠ•ç¨¿è©³ç´°ç”»é¢ã«ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚** å…¬é–‹ã•ã‚Œã¦ã‚‚å•é¡Œã®ãªã„å†…å®¹ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚
                </p>
            </div>

            <div class="flex justify-between items-center pt-6 border-t mt-8">
                <a href="{% url 'main:admin_post_detail' post.id %}" class="text-gray-600 hover:text-gray-800 text-base py-2 px-4 rounded-lg border border-gray-300 hover:bg-gray-50 transition duration-150">
                    ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                </a>
                <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-lg shadow-lg transition duration-150">
                    ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¨˜éŒ²ã™ã‚‹
                </button>
            </div>
        </form>
    </main>
</div>

{% endblock %}